<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Trang Web C·ªßa Tr√≠ - Full Game</title>
<style>
html, body {margin:0; padding:0; width:100%; height:100%; font-family:Arial,sans-serif; overflow:hidden;}
body {background:url("tri-an-pizza.jpg") no-repeat center center fixed; background-size:cover; display:flex; justify-content:center; align-items:center; color:white;}
.overlay {position:fixed; inset:0; background:rgba(0,0,0,0.25); z-index:0;}
.content {position:relative; z-index:2; width:90%; max-width:600px; max-height:95vh; overflow-y:auto; padding:20px; text-align:center;}
button {margin-top:20px; padding:12px 25px; font-size:18px; border:none; border-radius:10px; cursor:pointer;}
.yt-btn { background:red; color:white; box-shadow:0 0 10px red;}
.next-btn, .check-btn, .reward-btn { background:yellow;}
.question-box {background:rgba(0,0,0,0.6); padding:25px; border-radius:15px; margin-top:20px;}
.answer {margin:10px 0; padding:12px; background:rgba(255,255,255,0.2); border-radius:8px; cursor:pointer; border:2px solid transparent;}
.answer.selected {border:2px solid yellow; background:rgba(255,255,150,0.3);}
.main-image {max-width:100%; max-height:55vh; border-radius:10px; margin:15px auto; display:block;}
.phone-box {margin-top:15px; font-size:22px; font-weight:bold; color:black; background:rgba(255,255,255,0.85); padding:10px 20px; border-radius:10px; border:4px solid red; animation:glow 1s infinite alternate;}
@keyframes glow { from { box-shadow:0 0 5px red;} to { box-shadow:0 0 20px yellow; } }
.update-box { margin-top:25px; background:rgba(0,0,0,0.6); padding:15px; border-radius:15px; text-align:left; }
.update-box h2 { text-align:center; color:#ffd700; }
.update-box li { margin:6px 0; font-size:15px; }

/* Intro menu (game) */
#introMenu {
  display:none;
  position:fixed;
  inset:0;
  z-index:20;
  background:rgba(0,0,0,0.85);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  text-align:center;
}
#introMenu h1 { font-size:40px; margin:6px 0; color:#ffd700; }
.play-btn-game { background:lime; font-size:22px; padding:15px 40px; border-radius:15px; margin:10px; cursor:pointer; }

/* Game area */
#gameArea {display:none; position:relative; z-index:2; width:90%; max-width:1000px; max-height:95vh; margin:auto; text-align:center; background:rgba(0,0,0,0.6); border-radius:15px; padding:15px; overflow:auto;}
#playerProfile,#shopArea,#worldList,#stageList {display:inline-block; vertical-align:top; margin-right:20px;}
#playerProfile {width:250px; text-align:left;}
#shopArea {width:200px; text-align:left;}
#battleContent{display:inline-block; vertical-align:top; width:400px; text-align:center;}
.stats { margin-top:10px; }
.hp-bar { width:100%; height:20px; background:#555; border-radius:10px; margin:5px 0; }
.hp-fill { height:100%; background:lime; border-radius:10px; text-align:center; color:black; font-weight:bold; }
#actions button{margin:5px; padding:8px 15px;}
#log{height:140px; overflow-y:auto; text-align:left; margin-top:10px; background:rgba(255,255,255,0.1); padding:10px; border-radius:10px;}
#snow {position:fixed; inset:0; pointer-events:none; z-index:1;}
.levelup-box {background:rgba(0,0,0,0.6); padding:20px; border-radius:15px; margin-top:15px;}
.levelup-box button {margin:5px;}
</style>
</head>
<body>

<div class="overlay"></div>
<canvas id="snow"></canvas>

<!-- MENU WEB (GI·ªÆ NGUY√äN) -->
<div class="content" id="mainContent">
    <h1>Ch√†o m·ª´ng ƒë·∫øn trang web c·ªßa Tr√≠!</h1>
    <p>B·∫°n c√≥ th·ªÉ h·ªçc saygex ch·ªâ 4 ƒë√¥ m·ªói th√°ng.</p>
    <img src="tritangquafemboy.jpg" class="main-image">
    <div class="phone-box">‚òéÔ∏è 036-670-1818</div>
    <button class="yt-btn" onclick="startRegister()">ƒêƒÇNG K√ç</button>
    <div class="update-box">
        <h2>üìå C·∫≠p nh·∫≠t website</h2>
        <ul>
            <li>üéÑ Hi·ªáu ·ª©ng tuy·∫øt r∆°i Gi√°ng Sinh</li>
            <li>üß† Test 10 c√¢u h·ªèi c√≥ h√¨nh ·∫£nh</li>
            <li>üéÅ Ph·∫ßn th∆∞·ªüng th·∫Øng / thua</li>
            <li>üéÆ Game Mini World/Stage + Level Up</li>
        </ul>
    </div>
</div>

<!-- INTRO MENU GAME: Tr√°y Ghi Aura -->
<div id="introMenu">
  <h1>Tr√°y Ghi Aura</h1>
  <p style="margin:6px 0 14px 0;">S·∫µn s√†ng cho cu·ªôc phi√™u l∆∞u?</p>
  <button class="play-btn-game" onclick="startGameFeature()">Play</button>
  <button class="yt-btn" onclick="closeIntroMenu()">Tho√°t</button>
</div>

<!-- GAME AREA (GI·ªÆ NGUY√äN LOGIC) -->
<div id="gameArea">
    <div id="playerProfile"></div>
    <div id="shopArea"><h3>Shop / Gacha</h3><p>Ch∆∞a c√≥ item</p></div>
    <div id="worldList"></div>
    <div id="stageList"></div>
    <div id="battleContent">
        <div id="battlePlayer"></div>
        <div class="hp-bar"><div id="battlePlayerHP" class="hp-fill"></div></div>
        <div id="battleMonster"></div>
        <div class="hp-bar"><div id="battleMonsterHP" class="hp-fill"></div></div>
        <div id="actions"></div>
        <div id="log"></div>
    </div>
</div>

<script>
// ===== TEST + PH·∫¶N TH∆Ø·ªûNG (KH√îNG THAY ƒê·ªîI) =====
let questions = [
 {img:"giathinh.png",ask:"C√¢u 1: ƒê√¢y l√† con g√¨?",answers:["A. Con m√®o","B. Con ch√≥","C. Con g√†","D. Con heo"],correct:1},
 {img:"minhtrithamquan.jpg",ask:"C√¢u 2: Tr√≠ th√≠ch g√¨ nh·∫•t?",answers:["A. ƒÇn g√¨","B. Ng·ªß","C. Ch∆°i game","D. C·∫£ 3"],correct:3},
 {ask:"C√¢u 3: B·∫°n ƒë·∫øn trang n√†y ƒë·ªÉ l√†m g√¨?",answers:["A. Gi·∫£i tr√≠","B. L√†m b√†i test","C. Xem web","D. C·∫£ 3"],correct:3},
 {img:"phong2.jpg",ask:"C√¢u 4: Trong h√¨nh l√† g√¨?",answers:["A. TP sƒ© aura","B. Con v·∫≠t","C. ƒê·ªì v·∫≠t","D. Kh√¥ng bi·∫øt"],correct:0},
 {ask:"C√¢u 5: 2 + 2 = ?",answers:["A. 3","B. 4","C. 5","D. 6"],correct:1},
 {ask:"C√¢u 6: Ai y√™u nhi nh·∫•t?",answers:["A. t√¥i","B. thk ·∫£o aura","C. ko c√≥","D. b·∫°n t√¥i"],correct:1},
 {ask:"C√¢u 7: M·ªôt tu·∫ßn Tr√≠ ch∆°i game m·∫•y l·∫ßn?",answers:["A. 5","B. 6","C. 7","D. 8"],correct:2},
 {ask:"C√¢u 8: TP c√≥ h√¨nh g√¨?",answers:["A. Vu√¥ng","B. Tam gi√°c","C. Tr√≤n","D. H√¨nh Pheo.B"],correct:3},
 {ask:"C√¢u 9: Lo√†i n√†o bi·∫øt bay?",answers:["A. C√° h·ªìi","B. Chim","C. Kh√°c","D. Y√™u femboy"],correct:1},
 {ask:"C√¢u 10: Ai n√≥i c√¢u 'tao kh√¥ng gi·∫øt ƒë∆∞·ª£c m√†y th√¨ tao l√†m ch√≥'?",answers:["A. TP","B. MT","C. NA","D. TN"],correct:0}
];
let i=0, score=0, pick=-1;

function startRegister(){
  const c = document.getElementById("mainContent");
  c.innerHTML = `<h1>Tr∆∞·ªõc khi ƒëƒÉng k√Ω b·∫°n ph·∫£i ho√†n th√†nh b√†i test!</h1>
    <div id="q"></div>
    <button class="yt-btn" id="startTestBtn">B·∫ÆT ƒê·∫¶U TEST</button>`;
  i=0; score=0; pick=-1;
  document.getElementById("startTestBtn").onclick = startTest;
}

function startTest(){
  document.getElementById("startTestBtn").style.display = "none";
  loadQ();
}

function loadQ(){
  let q=questions[i];
  let qDiv = document.getElementById("q");
  let h = `<div class="question-box"><h2>${q.ask}</h2>`;
  if(q.img) h += `<img src="${q.img}" class="main-image">`;
  q.answers.forEach((a,n)=>{
    h += `<div class="answer" onclick="
      pick=${n};
      document.querySelectorAll('.answer').forEach(x=>x.classList.remove('selected'));
      event.target.classList.add('selected')
    ">${a}</div>`;
  });
  h += `<button class="next-btn" onclick="nextQ()">Ti·∫øp theo</button></div>`;
  qDiv.innerHTML = h;
}

function nextQ(){
  if(pick===-1){ alert("Ch·ªçn ƒë√°p √°n"); return; }
  if(pick===questions[i].correct) score++;
  pick=-1; i++;
  if(i>=questions.length) showResult();
  else loadQ();
}

function showResult(){
  const c=document.getElementById("mainContent");
  if(score===questions.length){
    c.innerHTML=`<h1 style="color:lightgreen">‚úîÔ∏è B·∫°n ƒë√£ v∆∞·ª£t qua 10/10!</h1>
      <button class="reward-btn" onclick="reward(true)">Nh·∫≠n ph·∫ßn th∆∞·ªüng</button>
      <div id="r"></div>
      <button class="yt-btn" onclick="unlockGame()">M·ªü kh√≥a game</button>`;
  } else {
    c.innerHTML=`<h1 style="color:red">‚ùå B·∫°n ch∆∞a ƒë·∫°t (${score}/${questions.length})</h1>
      <button class="reward-btn" onclick="reward(false)">Nh·∫≠n qu√† an ·ªßi</button>
      <div id="r"></div>
      <button class="yt-btn" style="margin-top:15px" onclick="startRegister()">L√†m l·∫°i</button>`;
  }
}

function reward(win){
  document.getElementById("r").innerHTML =
    win? `<img src="spiritfruit.webp" class="main-image">`:
         `<img src="trijumscare.jpg" class="main-image">`;
  if(win) localStorage.setItem("testCompleted","true");
}

function unlockGame(){ localStorage.setItem("featureUnlocked","true"); location.reload(); }

function showGameButton(){
 if(localStorage.getItem("featureUnlocked")==="true"){
   if(!document.querySelector("#gameButton")){
     let btn=document.createElement("button");
     btn.id="gameButton"; btn.innerText="üéÆ Ch∆°i Game"; btn.className="yt-btn";
     btn.style.position="fixed"; btn.style.left="10px"; btn.style.top="10px"; btn.style.zIndex="999";
     btn.onclick=()=>{ document.getElementById("mainContent").style.display="none"; document.getElementById("introMenu").style.display="flex"; };
     document.body.appendChild(btn);
   }
 }
}

window.onload = showGameButton;

// ===== MINI GAME TR√ÅY GHI AURA NGUY√äN B·∫¢N =====
let player=null, monster=null, turn="player", currentWorld=0, currentStage=0;
let worlds=[], totalWorlds=3, stagesPerWorld=5;
let completedStages=JSON.parse(localStorage.getItem("completedStages")||"{}");

// T·∫°o d·ªØ li·ªáu world/stage nguy√™n b·∫£n
for(let w=0; w<totalWorlds; w++){
 let stages=[];
 for(let s=0; s<stagesPerWorld; s++){
  stages.push({name:`Qu√°i ${w+1}-${s+1}`, hp:30+10*w+10*s, maxHp:30+10*w+10*s, skills:[{name:"ƒê·∫•m", dmg:5+2*s},{name:"R·ªìng l·ª≠a", dmg:6+2*s}], reward:{exp:10*s*(w+1), gold:5*s*(w+1)}});
 }
 worlds.push({world:w+1, stages:stages});
}

// Load player nguy√™n b·∫£n
function loadPlayer(){
 let saved = JSON.parse(localStorage.getItem("playerStats"));
 if(saved) player=saved; else player={name:"Th·∫ßy gi√°o Tr√°y", hp:120, maxHp:120, exp:0, gold:0, level:1, points:0, skills:[{name:"C·∫Øn", dmg:8},{name:"H√∫t m√°u", dmg:12}]};
 savePlayer();
}
function savePlayer(){ localStorage.setItem("playerStats", JSON.stringify(player)); }

// ===== MENU GAME =====
function startGameFeature(){
  // n·∫øu ƒëang ·ªü intro menu, ·∫©n intro menu tr∆∞·ªõc khi v√†o game
  const intro = document.getElementById("introMenu");
  if(intro) intro.style.display = "none";

  document.getElementById("mainContent").style.display="none";
  document.getElementById("gameArea").style.display="block";
  loadPlayer();
  showProfile();
  showWorlds();
  document.getElementById("stageList").innerHTML="";
  document.getElementById("battleContent").style.display="none";
}

function closeIntroMenu(){
  // quay l·∫°i menu web
  document.getElementById("introMenu").style.display="none";
  document.getElementById("mainContent").style.display="block";
}

// --- Profile / Worlds / Stages & Battle (gi·ªØ nguy√™n) ---
function startGameMenu(){
 loadPlayer();
 showProfile();
 showWorlds();
 document.getElementById("stageList").innerHTML="";
 document.getElementById("battleContent").style.display="none";
}

function showProfile(){
 let profile=document.getElementById("playerProfile");
 profile.innerHTML=`<h2>Profile: ${player.name}</h2>
 HP: <div class="hp-bar"><div class="hp-fill" style="width:${player.hp/player.maxHp*100}%">${player.hp}/${player.maxHp}</div></div>
 EXP: ${player.exp} Gold: ${player.gold} Level: ${player.level}`;
}

function showWorlds(){
 let container=document.getElementById("worldList");
 container.innerHTML="<h3>Worlds</h3>";
 for(let w=0; w<worlds.length; w++){
  let btn=document.createElement("button"); btn.className="yt-btn"; btn.innerText="World "+(w+1);
  btn.onclick=()=>showStages(w);
  container.appendChild(btn);
 }
}

function showStages(worldIdx){
 currentWorld=worldIdx;
 let container=document.getElementById("stageList"); container.innerHTML=`<h3>Stages - World ${worldIdx+1}</h3>`;
 worlds[worldIdx].stages.forEach((stage,sIdx)=>{
   let btn=document.createElement("button"); btn.innerText=stage.name;
   if(!completedStages[`W${worldIdx}S${sIdx-1}`] && sIdx>0) btn.disabled=true;
   btn.onclick=()=>startBattle(sIdx);
   container.appendChild(btn);
 });
}

function startBattle(stageIdx){
 currentStage=stageIdx;
 monster=JSON.parse(JSON.stringify(worlds[currentWorld].stages[stageIdx]));
 turn="player";
 player.hp=player.hp>0?player.hp:player.maxHp;
 document.getElementById("battleContent").style.display="block";
 updateBattle();
 createActions();
 let exitBtn = document.querySelector("#gameArea button.exitBtn");
 if(exitBtn) exitBtn.remove();
 let exitBtn2 = document.createElement("button");
 exitBtn2.className="exitBtn"; exitBtn2.innerText="Tho√°t v·ªÅ menu";
 exitBtn2.onclick=()=>{ document.getElementById("battleContent").style.display="none"; document.getElementById("stageList").innerHTML=""; startGameMenu(); };
 document.getElementById("gameArea").appendChild(exitBtn2);
}

function updateBattle(){
 document.getElementById("battlePlayer").innerText=player.name;
 document.getElementById("battlePlayerHP").style.width=player.hp/player.maxHp*100+"%";
 document.getElementById("battlePlayerHP").innerText=`${player.hp}/${player.maxHp}`;
 document.getElementById("battleMonster").innerText=monster.name;
 document.getElementById("battleMonsterHP").style.width=monster.hp/monster.maxHp*100+"%";
 document.getElementById("battleMonsterHP").innerText=`${monster.hp}/${monster.maxHp}`;
 showProfile();
}

function createActions(){
 let actionsDiv=document.getElementById("actions"); actionsDiv.innerHTML="";
 if(player.hp<=0 || monster.hp<=0){
   let btn=document.createElement("button"); btn.innerText="Ch∆°i l·∫°i Stage"; btn.onclick=()=>startBattle(currentStage);
   actionsDiv.appendChild(btn); return;
 }
 player.skills.forEach(s=>{
  let btn=document.createElement("button"); btn.innerText=s.name; btn.onclick=()=>{
    if(turn!="player") return;
    monster.hp=Math.max(0,monster.hp-s.dmg);
    document.getElementById("log").innerHTML+=`<p>B·∫°n d√πng ${s.name}, g√¢y ${s.dmg} dmg!</p>`;
    updateBattle();
    if(monster.hp<=0){
      document.getElementById("log").innerHTML+=`<p>üéâ B·∫°n th·∫Øng Stage!</p>`;
      player.exp+=monster.reward.exp; player.gold+=monster.reward.gold;
      levelUpCheck();
      completedStages[`W${currentWorld}S${currentStage}`]=true; localStorage.setItem("completedStages", JSON.stringify(completedStages));
      savePlayer(); updateBattle(); createActions(); return;
    }
    turn="monster"; setTimeout(monsterTurn,500);
  };
  actionsDiv.appendChild(btn);
 });
}

function monsterTurn(){
 let skill=monster.skills[Math.floor(Math.random()*monster.skills.length)];
 player.hp=Math.max(0,player.hp-skill.dmg);
 document.getElementById("log").innerHTML+=`<p>${monster.name} d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
 updateBattle();
 if(player.hp<=0){ document.getElementById("log").innerHTML+=`<p>üíÄ B·∫°n thua!</p>`; }
 turn="player"; createActions(); savePlayer();
}

function levelUpCheck(){
 let needed=player.level*50;
 if(player.exp>=needed){
  player.level++; player.exp-=needed; player.points=3;
  showLevelUpOptions();
 }
}

function showLevelUpOptions(){
 let log=document.getElementById("log");
 log.innerHTML+=`<div class="levelup-box"><p>‚ú® B·∫°n l√™n Level ${player.level}! Ch·ªçn 1 thu·ªôc t√≠nh ƒë·ªÉ tƒÉng (+3 ƒëi·ªÉm)</p></div>`;
 let box=document.createElement("div"); box.className="levelup-box";
 ["Health","Damage","Speed"].forEach(attr=>{
   let btn=document.createElement("button"); btn.innerText=attr; btn.onclick=()=>{
     if(attr=="Health") { player.maxHp+=10; player.hp=player.maxHp; }
     if(attr=="Damage") { player.skills.forEach(s=>s.dmg+=2); }
     if(attr=="Speed"){} // placeholder
     player.points=0; box.remove(); updateBattle(); savePlayer();
   };
   box.appendChild(btn);
 });
 log.appendChild(box);
}

// ===== HI·ªÜU ·ª®NG TUY·∫æT =====
const c=document.getElementById("snow"),x=c.getContext("2d");
function rs(){c.width=innerWidth;c.height=innerHeight}
rs();window.onresize=rs;
let snow=Array.from({length:120},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1,d:Math.random()+1}));
setInterval(()=>{x.clearRect(0,0,c.width,c.height);x.fillStyle="white";snow.forEach(f=>{x.beginPath();x.arc(f.x,f.y,f.r,0,Math.PI*2);x.fill();f.y+=f.d+1;if(f.y>c.height){f.y=0;f.x=Math.random()*c.width;}});},33);
</script>

</body>
</html>






































































































