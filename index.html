<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Tr√°y Aura Adventure</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;font-family:Arial,sans-serif;overflow:hidden;}
body{background:url("tri-an-pizza.jpg") no-repeat center center fixed;background-size:cover;color:white;display:flex;justify-content:center;align-items:center;}
#overlay{position:fixed;inset:0;background:rgba(0,0,0,0.25);z-index:0;}
.content{position:relative;z-index:2;width:90%;max-width:1000px;max-height:95vh;overflow-y:auto;padding:20px;text-align:center;background:rgba(0,0,0,0.5);border-radius:15px;}
button{margin:5px;padding:10px 20px;font-size:16px;border:none;border-radius:10px;cursor:pointer;}
.yt-btn{background:red;color:white;box-shadow:0 0 10px red;}
.skill-btn{background:yellow;color:black;}
.world-btn{background:orange;color:white;}
.answer{margin:10px 0;padding:12px;background:rgba(255,255,255,0.2);border-radius:8px;cursor:pointer;border:2px solid transparent;}
.answer.selected{border:2px solid yellow;background:rgba(255,255,150,0.3);}
.main-image{max-width:100%;max-height:55vh;border-radius:10px;margin:15px auto;display:block;}
#gameMenu{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:5;text-align:center;padding-top:50px;}
#gameMenu h1{font-size:50px;margin-bottom:20px;}
#gameHub,#stageSelect,#battleArea,#testArea{display:none;}
.hp-bar{width:100%;height:20px;background:#555;border-radius:10px;margin:5px 0;}
.hp-fill{height:100%;background:lime;border-radius:10px;text-align:center;color:black;font-weight:bold;}
#log{height:140px;overflow-y:auto;text-align:left;margin-top:10px;background:rgba(255,255,255,0.1);padding:10px;border-radius:10px;}
.stats{margin-top:10px;}
#snow{position:fixed;inset:0;pointer-events:none;z-index:1;}
</style>
</head>
<body>
<div id="overlay"></div>
<canvas id="snow"></canvas>

<!-- MAIN PAGE -->
<div class="content" id="mainContent">
  <h1>Ch√†o m·ª´ng ƒë·∫øn web c·ªßa Tr√≠!</h1>
  <img src="tritangquafemboy.jpg" class="main-image">
  <button class="yt-btn" onclick="startRegister()">ƒêƒÇNG K√ç</button>
</div>

<!-- TEST AREA -->
<div class="content" id="testArea"></div>

<!-- GAME MENU -->
<div id="gameMenu">
  <h1>Tr√°y Aura Adventure</h1>
  <p>Aura</p>
  <button onclick="enterGameHub()">PLAY</button>
  <button onclick="exitGameMenu()">Tho√°t Game</button>
</div>

<!-- GAME HUB -->
<div id="gameHub" class="content">
  <div id="playerProfile">
    <h2>Profile: Th·∫ßy gi√°o Tr√°y</h2>
    <p>Level: <span id="playerLevel">1</span></p>
    <p>HP: <span id="playerHP"></span></p>
    <div class="hp-bar"><div id="playerHPFill" class="hp-fill"></div></div>
    <p>EXP: <span id="playerEXP">0</span></p>
    <p>Gold: <span id="playerGold">0</span></p>
    <button onclick="openStatMenu()">N√¢ng ch·ªâ s·ªë</button>
  </div>
  <div>
    <h2>Worlds</h2>
    <div id="worlds"></div>
  </div>
</div>

<!-- STAGE SELECT -->
<div id="stageSelect" class="content">
  <h2 id="stageTitle"></h2>
  <div id="stages"></div>
  <button onclick="backToHub()">Quay l·∫°i Game Hub</button>
</div>

<!-- BATTLE AREA -->
<div id="battleArea" class="content">
  <h2 id="battleTitle"></h2>
  <p id="battlePlayer"></p>
  <div class="hp-bar"><div id="battlePlayerHP" class="hp-fill"></div></div>
  <p id="battleMonster"></p>
  <div class="hp-bar"><div id="battleMonsterHP" class="hp-fill"></div></div>
  <div id="actions"></div>
  <div id="log"></div>
  <button onclick="exitBattle()">Tho√°t v·ªÅ Game Hub</button>
</div>

<script>
// ===== DATA =====
let player={name:"Th·∫ßy gi√°o Tr√°y",hp:120,maxHp:120,exp:0,gold:0,level:1,skills:[{name:"C·∫Øn",dmg:8},{name:"H√∫t m√°u",dmg:12}],statPoints:0};
let worlds=[];
for(let w=1;w<=4;w++){
  let stages=[];
  for(let s=1;s<=10;s++){
    stages.push({name:`Qu√°i ${w}-${s}`,hp:50+10*w+10*s,maxHp:50+10*w+10*s,skills:[{name:"ƒê·∫•m",dmg:5+2*s},{name:"R·ªìng l·ª≠a",dmg:6+2*s}],reward:{exp:10*s*w,gold:5*s*w},cleared:false});
  }
  worlds.push({world:w,stages:stages,unlocked:w===1});
}
let currentWorld=0,currentStage=0,turn="player";
let monster=null;

// ===== SAVE/LOAD =====
function saveGame(){
  localStorage.setItem("gameTr√°y",JSON.stringify({player:player,worlds:worlds}));
}
function loadGame(){
  let saved=localStorage.getItem("gameTr√°y");
  if(saved){
    let data=JSON.parse(saved);
    player=data.player;
    worlds=data.worlds;
  }
}
loadGame();

// ===== TEST AREA =====
let questions=[{img:"giathinh.png",ask:"C√¢u 1?",answers:["A","B","C","D"],correct:1}];
let i=0,pick=-1,score=0;
function startRegister(){
  document.getElementById("mainContent").style.display="none";
  document.getElementById("testArea").style.display="block";
  i=0;score=0;pick=-1; loadQuestion();
}
function loadQuestion(){
  let q=questions[i];
  let h=`<h2>${q.ask}</h2>`;
  if(q.img) h+=`<img src="${q.img}" class="main-image">`;
  q.answers.forEach((a,n)=>h+=`<div class="answer" onclick="pick=${n};this.parentElement.querySelectorAll('.answer').forEach(x=>x.classList.remove('selected'));this.classList.add('selected')">${a}</div>`);
  h+=`<button onclick="nextQ()">Ti·∫øp theo</button>`;
  document.getElementById("testArea").innerHTML=h;
}
function nextQ(){
  if(pick===-1){alert("Ch·ªçn ƒë√°p √°n");return;}
  if(pick==questions[i].correct)score++;
  pick=-1;i++;
  if(i>=questions.length){endTest();}
  else loadQuestion();
}
function endTest(){
  document.getElementById("testArea").innerHTML=`<h2>Test xong</h2><button onclick="unlockGame()">M·ªü kh√≥a Game</button>`;
}
function unlockGame(){localStorage.setItem("featureUnlocked","true");showGameButton();showGameMenu();}

// ===== GAME BUTTON & MENU =====
function showGameButton(){
  if(localStorage.getItem("featureUnlocked")=="true"){
    if(!document.getElementById("gameBtn")){
      let btn=document.createElement("button");
      btn.id="gameBtn"; btn.innerText="üéÆ Ch∆°i Game"; btn.className="yt-btn";
      btn.style.position="fixed";btn.style.top="10px";btn.style.left="10px";btn.style.zIndex=10;
      btn.onclick=showGameMenu;
      document.body.appendChild(btn);
    }
  }
}
function showGameMenu(){
  document.getElementById("gameMenu").style.display="block";
}
function exitGameMenu(){
  document.getElementById("gameMenu").style.display="none";
}

// ===== GAME HUB =====
function enterGameHub(){
  document.getElementById("gameMenu").style.display="none";
  document.getElementById("gameHub").style.display="block";
  updateProfile();
  showWorlds();
}
function showWorlds(){
  let container=document.getElementById("worlds");container.innerHTML="";
  worlds.forEach((w,i)=>{
    let btn=document.createElement("button");btn.className="world-btn";btn.innerText=`World ${w.world}`;
    btn.onclick=()=>{if(w.unlocked) showStages(i); else alert("Ch∆∞a m·ªü kh√≥a!");};
    container.appendChild(btn);
  });
}
function showStages(idx){
  currentWorld=idx;document.getElementById("gameHub").style.display="none";document.getElementById("stageSelect").style.display="block";
  document.getElementById("stageTitle").innerText=`Ch·ªçn Stage - World ${worlds[idx].world}`;
  let container=document.getElementById("stages");container.innerHTML="";
  worlds[idx].stages.forEach((st,i)=>{
    let btn=document.createElement("button");btn.innerText=`Stage ${i+1}`;
    btn.onclick=()=>startBattle(i);
    container.appendChild(btn);
  });
}
function backToHub(){document.getElementById("stageSelect").style.display="none";document.getElementById("gameHub").style.display="block";}

// ===== BATTLE =====
function startBattle(stageIdx){
  currentStage=stageIdx;
  let stage=worlds[currentWorld].stages[stageIdx];
  monster=JSON.parse(JSON.stringify(stage));
  player.hp=player.hp>0?player.hp:player.maxHp;
  turn="player";
  document.getElementById("stageSelect").style.display="none";document.getElementById("battleArea").style.display="block";
  document.getElementById("log").innerHTML="";
  updateBattle();createActions();
}
function updateProfile(){
  document.getElementById("playerHPFill").style.width=`${player.hp/player.maxHp*100}%`;
  document.getElementById("playerHPFill").innerText=`${player.hp}/${player.maxHp}`;
  document.getElementById("playerEXP").innerText=player.exp;
  document.getElementById("playerGold").innerText=player.gold;
  document.getElementById("playerLevel").innerText=player.level;
}
function updateBattle(){
  document.getElementById("battlePlayer").innerText=player.name;
  document.getElementById("battlePlayerHP").style.width=`${player.hp/player.maxHp*100}%`;
  document.getElementById("battlePlayerHP").innerText=`${player.hp}/${player.maxHp}`;
  document.getElementById("battleMonster").innerText=monster.name;
  document.getElementById("battleMonsterHP").style.width=`${monster.hp/monster.maxHp*100}%`;
  document.getElementById("battleMonsterHP").innerText=`${monster.hp}/${monster.maxHp}`;
}
function createActions(){
  let actions=document.getElementById("actions");actions.innerHTML="";
  if(player.hp<=0||monster.hp<=0){
    let btn=document.createElement("button");btn.innerText="Ch∆°i l·∫°i Stage";btn.onclick=()=>startBattle(currentStage);actions.appendChild(btn);return;
  }
  player.skills.forEach(skill=>{
    let btn=document.createElement("button");btn.className="skill-btn";btn.innerText=skill.name;
    btn.onclick=()=>playerAttack(skill);actions.appendChild(btn);
  });
}
function playerAttack(skill){
  monster.hp=Math.max(0,monster.hp-skill.dmg);
  document.getElementById("log").innerHTML+=`<p>B·∫°n d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
  updateBattle();
  if(monster.hp<=0){
    document.getElementById("log").innerHTML+=`<p>üéâ B·∫°n th·∫Øng Stage!</p>`;
    player.exp+=monster.reward.exp;player.gold+=monster.reward.gold;
    player.hp=player.maxHp; // h·ªìi full khi th·∫Øng
    worlds[currentWorld].stages[currentStage].cleared=true;
    checkLevelUp();
    createActions();updateProfile();saveGame();
    return;
  }
  turn="monster";setTimeout(monsterAttack,500);
}
function monsterAttack(){
  if(!monster||monster.hp<=0)return;
  let skill=monster.skills[Math.floor(Math.random()*monster.skills.length)];
  player.hp=Math.max(0,player.hp-skill.dmg);
  document.getElementById("log").innerHTML+=`<p>Qu√°i d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
  if(player.hp<=0)document.getElementById("log").innerHTML+=`<p>üíÄ B·∫°n thua!</p>`;
  turn="player";updateBattle();createActions();saveGame();
}
function exitBattle(){document.getElementById("battleArea").style.display="none";document.getElementById("gameHub").style.display="block";updateProfile();}
function checkLevelUp(){let needed=player.level*50;if(player.exp>=needed){player.level++;player.statPoints+=3;player.exp-=needed;updateProfile();alert("B·∫°n c√≥ 3 ƒëi·ªÉm n√¢ng ch·ªâ s·ªë!");}}
function openStatMenu(){if(player.statPoints>0){let points=player.statPoints;let choice=prompt(`B·∫°n c√≥ ${points} ƒëi·ªÉm, ch·ªçn Health/Damage (hp/dmg)`);if(choice=="hp"){player.maxHp+=10*points;player.hp=player.maxHp;}else if(choice=="dmg"){player.skills.forEach(s=>s.dmg+=2*points);}player.statPoints=0;updateProfile();saveGame();}else alert("Ch∆∞a c√≥ ƒëi·ªÉm n√¢ng!");}

// ===== SNOW =====
const c=document.getElementById("snow"),x=c.getContext("2d");function rs(){c.width=innerWidth;c.height=innerHeight;}rs();window.onresize=rs;
let s=Array.from({length:120},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1,d:Math.random()+1}));
setInterval(()=>{x.clearRect(0,0,c.width,c.height);x.fillStyle="white";s.forEach(f=>{x.beginPath();x.arc(f.x,f.y,f.r,0,Math.PI*2);x.fill();f.y+=f.d+1;if(f.y>c.height){f.y=0;f.x=Math.random()*c.width;}})},33);
</script>
</body>
</html>

















































































