<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Game Tr√°y - Gacha RPG Full</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;font-family:Arial,sans-serif;overflow:hidden;}
body{background:url("tri-an-pizza.jpg") no-repeat center center fixed;background-size:cover;color:white;display:flex;justify-content:center;align-items:center;}
#overlay{position:fixed;inset:0;background:rgba(0,0,0,0.25);z-index:0;}
#mainContent,#gameHub,#stageSelect,#battleArea{position:relative;z-index:2;width:90%;max-width:1000px;max-height:95vh;overflow-y:auto;padding:20px;text-align:center;background:rgba(0,0,0,0.5);border-radius:15px;}
button{margin:5px;padding:10px 20px;font-size:16px;border:none;border-radius:10px;cursor:pointer;}
.yt-btn{background:red;color:white;box-shadow:0 0 10px red;}
.world-btn{background:orange;color:white;}
.skill-btn{background:yellow;color:black;}
#playerProfile,#shopArea{display:inline-block;vertical-align:top;}
#playerProfile{width:250px;text-align:left;margin-right:20px;}
#shopArea{width:200px;text-align:left;margin-right:20px;}
#battleContent{display:inline-block;vertical-align:top;width:400px;text-align:center;}
.hp-bar{width:100%;height:20px;background:#555;border-radius:10px;margin:5px 0;}
.hp-fill{height:100%;background:lime;border-radius:10px;text-align:center;color:black;font-weight:bold;}
#log{height:140px;overflow-y:auto;text-align:left;margin-top:10px;background:rgba(255,255,255,0.1);padding:10px;border-radius:10px;}
</style>
</head>
<body>
<div id="overlay"></div>

<div id="mainContent">
    <h1>Ch√†o m·ª´ng ƒë·∫øn Game Tr√°y!</h1>
    <p>Nh·∫•n n√∫t d∆∞·ªõi ƒë·ªÉ v√†o Game Hub</p>
    <button class="yt-btn" onclick="enterGameHub()">üéÆ V√†o Game Tr√°y</button>
</div>

<div id="gameHub">
    <div id="playerProfile">
        <h2>Profile: Th·∫ßy gi√°o Tr√°y</h2>
        <p id="playerHP">HP:</p>
        <div class="hp-bar"><div id="playerHPFill" class="hp-fill"></div></div>
        <p id="playerEXP">EXP: 0</p>
        <p id="playerGold">Gold: 0</p>
        <p id="playerLevel">Level: 1</p>
    </div>

    <div id="shopArea">
        <h3>Shop / Gacha</h3>
        <p>Ch∆∞a c√≥ item</p>
    </div>

    <div style="display:inline-block;vertical-align:top;">
        <h2>Worlds</h2>
        <div id="worlds"></div>
    </div>
</div>

<div id="stageSelect">
    <h2 id="stageTitle"></h2>
    <div id="stages"></div>
    <button onclick="backToHub()">Quay l·∫°i Game Hub</button>
</div>

<div id="battleArea">
    <h2 id="battleTitle"></h2>
    <div id="battleContent">
        <p id="battlePlayer"></p>
        <div class="hp-bar"><div id="battlePlayerHP" class="hp-fill"></div></div>
        <p id="battleMonster"></p>
        <div class="hp-bar"><div id="battleMonsterHP" class="hp-fill"></div></div>
        <div id="actions"></div>
        <div id="log"></div>
        <button onclick="exitBattle()">Tho√°t v·ªÅ Game Hub</button>
    </div>
</div>

<script>
// ===== DATA =====
let player={name:"Th·∫ßy gi√°o Tr√°y",hp:120,maxHp:120,exp:0,gold:0,level:1,skills:[{name:"C·∫Øn",dmg:8},{name:"H√∫t m√°u",dmg:12}]};
let worlds=[];
for(let w=1;w<=4;w++){
    let stages=[];
    for(let s=1;s<=10;s++){
        stages.push({
            name:`Qu√°i ${w}-${s}`,
            hp:20+10*w+10*s,
            maxHp:20+10*w+10*s,
            skills:[{name:"ƒê·∫•m",dmg:5+2*s},{name:"R·ªìng l·ª≠a",dmg:6+2*s}],
            reward:{exp:10*s* w,gold:5*s*w}
        });
    }
    worlds.push({world:w,stages:stages});
}
let currentWorld=0,currentStage=0,turn="player";
let monster=null;

// ===== SAVE/LOAD =====
function saveGame(){
    localStorage.setItem("gameTr√°y",JSON.stringify({player:player}));
}
function loadGame(){
    let saved=localStorage.getItem("gameTr√°y");
    if(saved){
        let data=JSON.parse(saved);
        player=data.player;
    }
}
loadGame();

// ===== GAME HUB =====
function enterGameHub(){
    document.getElementById("mainContent").style.display="none";
    document.getElementById("gameHub").style.display="block";
    showWorlds();
    updateProfile();
}

function showWorlds(){
    let container=document.getElementById("worlds");
    container.innerHTML="";
    worlds.forEach((w,i)=>{
        let btn=document.createElement("button");
        btn.className="world-btn";
        btn.innerText=`World ${w.world}`;
        btn.onclick=()=>showStages(i);
        container.appendChild(btn);
    });
}

function showStages(worldIdx){
    currentWorld=worldIdx;
    document.getElementById("gameHub").style.display="none";
    document.getElementById("stageSelect").style.display="block";
    document.getElementById("stageTitle").innerText=`Ch·ªçn Stage - World ${worlds[worldIdx].world}`;
    let container=document.getElementById("stages");
    container.innerHTML="";
    worlds[worldIdx].stages.forEach((stage,idx)=>{
        let btn=document.createElement("button");
        btn.innerText=`Stage ${idx+1}`;
        btn.onclick=()=>startBattle(idx);
        container.appendChild(btn);
    });
}

function backToHub(){
    document.getElementById("stageSelect").style.display="none";
    document.getElementById("gameHub").style.display="block";
    showWorlds();
    updateProfile();
}

// ===== BATTLE =====
function startBattle(stageIdx){
    currentStage=stageIdx;
    monster=JSON.parse(JSON.stringify(worlds[currentWorld].stages[stageIdx]));
    turn="player";
    document.getElementById("stageSelect").style.display="none";
    document.getElementById("battleArea").style.display="block";
    document.getElementById("log").innerHTML="";
    updateBattle();
    createActions();
}

function updateProfile(){
    document.getElementById("playerHPFill").style.width=`${player.hp/player.maxHp*100}%`;
    document.getElementById("playerHPFill").innerText=`${player.hp}/${player.maxHp}`;
    document.getElementById("playerEXP").innerText=`EXP: ${player.exp}`;
    document.getElementById("playerGold").innerText=`Gold: ${player.gold}`;
    document.getElementById("playerLevel").innerText=`Level: ${player.level}`;
}

function updateBattle(){
    document.getElementById("battlePlayer").innerText=player.name;
    document.getElementById("battlePlayerHP").style.width=`${player.hp/player.maxHp*100}%`;
    document.getElementById("battlePlayerHP").innerText=`${player.hp}/${player.maxHp}`;
    document.getElementById("battleMonster").innerText=monster.name;
    document.getElementById("battleMonsterHP").style.width=`${monster.hp/monster.maxHp*100}%`;
    document.getElementById("battleMonsterHP").innerText=`${monster.hp}/${monster.maxHp}`;
}

function createActions(){
    let actionsDiv=document.getElementById("actions");
    actionsDiv.innerHTML="";
    if(player.hp<=0 || monster.hp<=0){
        let btn=document.createElement("button");
        btn.innerText="Ch∆°i l·∫°i Stage";
        btn.onclick=()=>startBattle(currentStage);
        actionsDiv.appendChild(btn);
        return;
    }
    player.skills.forEach(skill=>{
        let btn=document.createElement("button");
        btn.className="skill-btn";
        btn.innerText=skill.name;
        btn.onclick=()=>playerAttack(skill);
        actionsDiv.appendChild(btn);
    });
}

function playerAttack(skill){
    monster.hp=Math.max(0,monster.hp-skill.dmg);
    document.getElementById("log").innerHTML+=`<p>B·∫°n d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
    updateBattle();
    if(monster.hp<=0){
        document.getElementById("log").innerHTML+=`<p>üéâ B·∫°n th·∫Øng Stage!</p>`;
        player.exp+=monster.reward.exp;
        player.gold+=monster.reward.gold;
        checkLevelUp();
        updateProfile();
        createActions();
        saveGame();
        return;
    }
    turn="monster";
    setTimeout(monsterAttack,500);
}

function monsterAttack(){
    if(!monster || monster.hp<=0) return;
    let skill=monster.skills[Math.floor(Math.random()*monster.skills.length)];
    player.hp=Math.max(0,player.hp-skill.dmg);
    document.getElementById("log").innerHTML+=`<p>${monster.name} d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
    updateBattle();
    if(player.hp<=0){
        document.getElementById("log").innerHTML+=`<p>üíÄ B·∫°n thua Stage!</p>`;
    }
    createActions();
    saveGame();
}

function exitBattle(){
    document.getElementById("battleArea").style.display="none";
    document.getElementById("gameHub").style.display="block";
    updateProfile();
}

function checkLevelUp(){
    let needed=player.level*50;
    if(player.exp>=needed){
        player.level++;
        player.maxHp+=20;
        player.hp=player.maxHp;
        player.exp=player.exp-needed;
        document.getElementById("log").innerHTML+=`<p>‚ú® B·∫°n l√™n Level ${player.level}! HP t·ªëi ƒëa tƒÉng l√™n ${player.maxHp}</p>`;
    }
}

// ===== HI·ªÜU ·ª®NG TUY·∫æT =====
const c=document.createElement("canvas");
c.id="snow";
c.style.position="fixed";c.style.inset="0";c.style.pointerEvents="none";c.style.zIndex="1";
document.body.appendChild(c);
const x=c.getContext("2d");
function rs(){c.width=innerWidth;c.height=innerHeight}
rs();window.onresize=rs;
let s=Array.from({length:120},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1,d:Math.random()+1}));
setInterval(()=>{
 x.clearRect(0,0,c.width,c.height);
 x.fillStyle="white";
 s.forEach(f=>{x.beginPath();x.arc(f.x,f.y,f.r,0,Math.PI*2);x.fill();f.y+=f.d+1;if(f.y>c.height){f.y=0;f.x=Math.random()*c.width;}});
},33);
</script>
</body>
</html>








































































