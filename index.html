<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Trang Web C·ªßa Tr√≠ - Gacha RPG Full</title>
<style>
html, body {margin:0; padding:0; width:100%; height:100%; font-family:Arial,sans-serif; overflow:hidden;}
body {background:url("tri-an-pizza.jpg") no-repeat center center fixed; background-size:cover; color:white; display:flex; justify-content:center; align-items:center;}
.overlay {position:fixed; inset:0; background:rgba(0,0,0,0.25); z-index:0;}
.content, #gameArea, #gameHub, #stageSelect, #battleArea {position:relative; z-index:2; width:90%; max-width:1000px; max-height:95vh; overflow-y:auto; padding:20px; text-align:center; background:rgba(0,0,0,0.5); border-radius:15px;}
button {margin:5px; padding:10px 20px; font-size:16px; border:none; border-radius:10px; cursor:pointer;}
.yt-btn {background:red; color:white; box-shadow:0 0 10px red;}
.world-btn {background:orange; color:white;}
.skill-btn {background:yellow; color:black;}
#playerProfile,#shopArea {display:inline-block; vertical-align:top;}
#playerProfile {width:250px; text-align:left; margin-right:20px;}
#shopArea {width:200px; text-align:left; margin-right:20px;}
.hp-bar {width:100%; height:20px; background:#555; border-radius:10px; margin:5px 0;}
.hp-fill {height:100%; background:lime; border-radius:10px; text-align:center; color:black; font-weight:bold;}
#log {height:140px; overflow-y:auto; text-align:left; margin-top:10px; background:rgba(255,255,255,0.1); padding:10px; border-radius:10px;}
.stat-point {margin-top:5px;}
.stat-btn {margin:2px; padding:5px 10px; font-size:14px;}
#snow {position:fixed; inset:0; pointer-events:none; z-index:1;}
</style>
</head>
<body>

<div class="overlay"></div>
<canvas id="snow"></canvas>

<div class="content" id="mainContent">
    <h1>Ch√†o m·ª´ng ƒë·∫øn trang web c·ªßa Tr√≠!</h1>
    <p>B·∫°n c√≥ th·ªÉ h·ªçc saygex ch·ªâ 4 ƒë√¥ m·ªói th√°ng.</p>
    <img src="tritangquafemboy.jpg" style="max-width:100%; max-height:55vh; border-radius:10px; margin:15px auto; display:block;">
    <button class="yt-btn" onclick="startRegister()">ƒêƒÇNG K√ç / L√†m test</button>
    <div class="update-box">
        <h2>üìå C·∫≠p nh·∫≠t website</h2>
        <ul>
            <li>üéÑ Hi·ªáu ·ª©ng tuy·∫øt r∆°i Gi√°ng Sinh</li>
            <li>üß† Test 10 c√¢u h·ªèi c√≥ h√¨nh ·∫£nh</li>
            <li>üéÅ Ph·∫ßn th∆∞·ªüng th·∫Øng / thua</li>
            <li>üéÆ T√≠nh nƒÉng game s·∫Øp ho√†n th√†nh</li>
        </ul>
    </div>
</div>

<div id="gameHub" style="display:none;">
    <div id="playerProfile">
        <h2>Profile: Th·∫ßy gi√°o Tr√°y</h2>
        <p id="playerHP"></p>
        <div class="hp-bar"><div id="playerHPFill" class="hp-fill"></div></div>
        <p id="playerEXP"></p>
        <p id="playerGold"></p>
        <p id="playerLevel"></p>
        <p id="statPoints"></p>
        <div id="statButtons"></div>
    </div>
    <div id="shopArea">
        <h3>Shop / Gacha</h3>
        <p>Ch∆∞a c√≥ item</p>
    </div>
    <div style="display:inline-block;vertical-align:top;">
        <h2>Worlds</h2>
        <div id="worlds"></div>
    </div>
</div>

<div id="stageSelect" style="display:none;">
    <h2 id="stageTitle"></h2>
    <div id="stages"></div>
    <button onclick="backToHub()">Quay l·∫°i Game Hub</button>
</div>

<div id="battleArea" style="display:none;">
    <h2 id="battleTitle">Ph√≥ b·∫£n ƒë√°nh qu√°i</h2>
    <div id="battleContent">
        <p id="battlePlayer"></p>
        <div class="hp-bar"><div id="battlePlayerHP" class="hp-fill"></div></div>
        <p id="battleMonster"></p>
        <div class="hp-bar"><div id="battleMonsterHP" class="hp-fill"></div></div>
        <div id="actions"></div>
        <div id="log"></div>
        <button onclick="exitBattle()">Tho√°t v·ªÅ Game Hub</button>
    </div>
</div>

<script>
// ===== DATA GAME =====
let player = {name:"Th·∫ßy gi√°o Tr√°y", hp:120, maxHp:120, exp:0, gold:0, level:1, skillPts:0, stats:{health:0,dame:0,speed:0}, skills:[{name:"C·∫Øn", dmg:8},{name:"H√∫t m√°u", dmg:12}]};
let worlds = [];
for(let w=1; w<=4; w++){
    let stages=[];
    for(let s=1;s<=10;s++){
        stages.push({name:`Qu√°i ${w}-${s}`, hp:20+10*w+10*s, maxHp:20+10*w+10*s, skills:[{name:"ƒê·∫•m", dmg:5+2*s},{name:"R·ªìng l·ª≠a", dmg:6+2*s}], reward:{exp:10*s*w, gold:5*s*w}});
    }
    worlds.push({world:w, stages:stages});
}
let currentWorld=0, currentStage=0, turn="player", monster=null;

// ===== SAVE/LOAD =====
function saveGame(){
    localStorage.setItem("gameFull", JSON.stringify({player:player, currentWorld:currentWorld}));
}
function loadGame(){
    let saved = localStorage.getItem("gameFull");
    if(saved){
        let data = JSON.parse(saved);
        player = data.player;
        currentWorld = data.currentWorld;
    }
}

// ===== GAME HUB =====
function enterGameHub(){
    loadGame();
    document.getElementById("mainContent").style.display="none";
    document.getElementById("gameHub").style.display="block";
    showWorlds();
    updateProfile();
}
function showWorlds(){
    let container = document.getElementById("worlds");
    container.innerHTML="";
    worlds.forEach((w,i)=>{
        let btn = document.createElement("button");
        btn.className="world-btn";
        btn.innerText=`World ${w.world}`;
        btn.onclick=()=>showStages(i);
        container.appendChild(btn);
    });
}
function showStages(worldIdx){
    currentWorld = worldIdx;
    document.getElementById("gameHub").style.display="none";
    document.getElementById("stageSelect").style.display="block";
    document.getElementById("stageTitle").innerText=`Ch·ªçn Stage - World ${worlds[worldIdx].world}`;
    let container = document.getElementById("stages");
    container.innerHTML="";
    worlds[worldIdx].stages.forEach((s,idx)=>{
        let btn = document.createElement("button");
        btn.innerText=`Stage ${idx+1}`;
        btn.onclick=()=>startBattle(idx);
        container.appendChild(btn);
    });
}
function backToHub(){
    document.getElementById("stageSelect").style.display="none";
    document.getElementById("gameHub").style.display="block";
    showWorlds();
    updateProfile();
}

// ===== BATTLE =====
function startBattle(stageIdx){
    currentStage = stageIdx;
    monster = JSON.parse(JSON.stringify(worlds[currentWorld].stages[stageIdx]));
    player.hp = player.hp <=0 ? player.maxHp : player.hp; // h·ªìi m√°u n·∫øu ch·∫øt
    turn="player";
    document.getElementById("stageSelect").style.display="none";
    document.getElementById("battleArea").style.display="block";
    document.getElementById("log").innerHTML="";
    updateBattle();
    createActions();
}

function updateProfile(){
    document.getElementById("playerHPFill").style.width=`${player.hp/player.maxHp*100}%`;
    document.getElementById("playerHPFill").innerText=`${player.hp}/${player.maxHp}`;
    document.getElementById("playerEXP").innerText=`EXP: ${player.exp}`;
    document.getElementById("playerGold").innerText=`Gold: ${player.gold}`;
    document.getElementById("playerLevel").innerText=`Level: ${player.level}`;
    document.getElementById("statPoints").innerText=`ƒêi·ªÉm n√¢ng: ${player.skillPts}`;
    let statDiv = document.getElementById("statButtons");
    statDiv.innerHTML="";
    if(player.skillPts>0){
        ["health","dame","speed"].forEach(s=>{
            let btn = document.createElement("button");
            btn.innerText=`+1 ${s}`;
            btn.className="stat-btn";
            btn.onclick=()=>{
                player.stats[s]+=1;
                if(s==="health"){player.maxHp+=10; player.hp+=10;}
                if(s==="dame"){player.skills.forEach(k=>k.dmg+=2);}
                player.skillPts--;
                updateProfile();
                saveGame();
            };
            statDiv.appendChild(btn);
        });
    }
}

function updateBattle(){
    document.getElementById("battlePlayer").innerText = player.name;
    document.getElementById("battlePlayerHP").style.width=`${player.hp/player.maxHp*100}%`;
    document.getElementById("battlePlayerHP").innerText=`${player.hp}/${player.maxHp}`;
    document.getElementById("battleMonster").innerText = monster.name;
    document.getElementById("battleMonsterHP").style.width=`${monster.hp/monster.maxHp*100}%`;
    document.getElementById("battleMonsterHP").innerText=`${monster.hp}/${monster.maxHp}`;
}

function createActions(){
    let actionsDiv = document.getElementById("actions");
    let logDiv = document.getElementById("log");
    actionsDiv.innerHTML="";
    if(player.hp<=0 || monster.hp<=0){
        let btn = document.createElement("button");
        btn.innerText="Ch∆°i l·∫°i Stage";
        btn.onclick=()=>{
            if(player.hp<=0){player.hp=player.maxHp;} // h·ªìi full n·∫øu ch·∫øt
            monster = JSON.parse(JSON.stringify(worlds[currentWorld].stages[currentStage]));
            turn="player";
            updateBattle();
            createActions();
        };
        actionsDiv.appendChild(btn);
        return;
    }
    player.skills.forEach(skill=>{
        let btn = document.createElement("button");
        btn.className="skill-btn";
        btn.innerText=skill.name;
        btn.onclick=()=>playerAttack(skill);
        actionsDiv.appendChild(btn);
    });
}

function playerAttack(skill){
    monster.hp=Math.max(0,monster.hp-skill.dmg);
    document.getElementById("log").innerHTML+=`<p>B·∫°n d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
    updateBattle();
    if(monster.hp<=0){
        document.getElementById("log").innerHTML+=`<p>üéâ B·∫°n th·∫Øng Stage!</p>`;
        player.exp += monster.reward.exp;
        player.gold += monster.reward.gold;
        player.skillPts+=3; // th∆∞·ªüng 3 ƒëi·ªÉm n√¢ng
        checkLevelUp();
        updateProfile();
        createActions();
        saveGame();
        return;
    }
    turn="monster";
    setTimeout(monsterAttack,500);
}

function monsterAttack(){
    if(!monster || monster.hp<=0) return;
    let skill=monster.skills[Math.floor(Math.random()*monster.skills.length)];
    player.hp=Math.max(0,player.hp-skill.dmg);
    document.getElementById("log").innerHTML+=`<p>Qu√°i d√πng ${skill.name}, g√¢y ${skill.dmg} dmg!</p>`;
    updateBattle();
    if(player.hp<=0){
        document.getElementById("log").innerHTML+=`<p>üíÄ B·∫°n thua Stage!</p>`;
    }
    createActions();
    saveGame();
}

function exitBattle(){
    document.getElementById("battleArea").style.display="none";
    document.getElementById("gameHub").style.display="block";
    updateProfile();
}

function checkLevelUp(){
    let needed = player.level*50;
    if(player.exp>=needed){
        player.level++;
        player.exp -= needed;
        player.skillPts +=3; // 3 ƒëi·ªÉm n√¢ng m·ªói level
        player.maxHp += 20;
        player.hp = player.maxHp;
        document.getElementById("log").innerHTML+=`<p>‚ú® B·∫°n l√™n Level ${player.level}! HP t·ªëi ƒëa tƒÉng l√™n ${player.maxHp}</p>`;
    }
    updateProfile();
    saveGame();
}

// ===== TEST + M·ªû KH√ìA GAME =====
let questions=[
 { ask:"C√¢u 1?", answers:["A","B","C","D"], correct:1 },
 { ask:"C√¢u 2?", answers:["A","B","C","D"], correct:0 },
 { ask:"C√¢u 3?", answers:["A","B","C","D"], correct:2 },
 { ask:"C√¢u 4?", answers:["A","B","C","D"], correct:3 },
 { ask:"C√¢u 5?", answers:["A","B","C","D"], correct:1 },
 { ask:"C√¢u 6?", answers:["A","B","C","D"], correct:2 },
 { ask:"C√¢u 7?", answers:["A","B","C","D"], correct:0 },
 { ask:"C√¢u 8?", answers:["A","B","C","D"], correct:3 },
 { ask:"C√¢u 9?", answers:["A","B","C","D"], correct:1 },
 { ask:"C√¢u 10?", answers:["A","B","C","D"], correct:2 }
];
let i=0,score=0,pick=-1;

function startRegister(){
    document.getElementById("mainContent").innerHTML=`<h1>Tr∆∞·ªõc khi ƒëƒÉng k√Ω b·∫°n ph·∫£i ho√†n th√†nh b√†i test!</h1><div id="q"></div>`;
    i=0; score=0; pick=-1;
    loadQuestion();
}

function loadQuestion(){
    if(i>=questions.length){showResult(); return;}
    let q = questions[i];
    let h = `<h2>${q.ask}</h2>`;
    q.answers.forEach((a,n)=>{ h+=`<div class="answer" onclick="pick=${n};document.querySelectorAll('.answer').forEach(x=>x.classList.remove('selected'));event.target.classList.add('selected')">${a}</div>`;});
    h+=`<button onclick="nextQ()">Ti·∫øp</button>`;
    document.getElementById("q").innerHTML=h;
}

function nextQ(){
    if(pick==-1) return alert("Ch·ªçn ƒë√°p √°n");
    if(pick==questions[i].correct) score++;
    pick=-1; i++;
    loadQuestion();
}

function showResult(){
    document.getElementById("mainContent").innerHTML=`<h2>K·∫øt qu·∫£: ${score}/${questions.length}</h2>`;
    if(score>=7){ // v∆∞·ª£t qua
        localStorage.setItem("featureUnlocked","true");
        let btn = document.createElement("button");
        btn.innerText="üéÆ Ch∆°i Game";
        btn.className="yt-btn";
        btn.onclick=startGameHubFromMain;
        document.getElementById("mainContent").appendChild(btn);
    } else {document.getElementById("mainContent").innerHTML+="<p>Kh√¥ng ƒë·∫°t, th·ª≠ l·∫°i sau</p>";}
}

function startGameHubFromMain(){enterGameHub(); showGameButton();}

// ===== HI·ªÜU ·ª®NG TUY·∫æT =====
const c=document.getElementById("snow"), x=c.getContext("2d");
function rs(){c.width=innerWidth;c.height=innerHeight} rs(); window.onresize=rs;
let s=Array.from({length:120},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*3+1,d:Math.random()+1}));
setInterval(()=>{ x.clearRect(0,0,c.width,c.height); x.fillStyle="white"; s.forEach(f=>{x.beginPath(); x.arc(f.x,f.y,f.r,0,Math.PI*2); x.fill(); f.y+=f.d+1; if(f.y>c.height){f.y=0; f.x=Math.random()*c.width;} }); },33);

// ===== SHOW GAME BUTTON IF UNLOCKED =====
function showGameButton(){
    if(localStorage.getItem("featureUnlocked")=="true" && !document.querySelector("#gameButton")){
        let btn=document.createElement("button");
        btn.id="gameButton";
        btn.innerText="üéÆ Ch∆°i Game";
        btn.className="yt-btn";
        btn.style.position="fixed";
        btn.style.left="10px";
        btn.style.top="10px";
        btn.style.zIndex="999";
        btn.onclick=startGameHubFromMain;
        document.body.appendChild(btn);
    }
}
window.onload=showGameButton;

</script>
</body>
</html>














































































